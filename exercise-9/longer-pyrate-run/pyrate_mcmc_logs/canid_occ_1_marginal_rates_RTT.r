# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/labwork/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/labwork/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.194075689834, 0.194075689834,0.194075689834,0.192276097014,0.104423700139,0.0484503311977,0.0477527344745,0.0477527344745,0.0477527344745,0.0477527344745,0.0477527344745,0.0478182122242,0.0477527344745,0.0477527344745,0.0477527344745,0.0474487342784,0.0505798119243,0.0560614120495,0.0572374129578,0.0608443118038,0.0680108056201,0.0711244288049,0.0770264956533,0.0890591891837,0.0897325357783,0.0895152434413,0.0920309291421,0.0897325357783,0.0926799833999,0.0898547739158,0.0895152434413,0.126683686321,0.145442230642,0.145442230642,0.149363766037,0.153747159313,0.149322398442,0.145442230642,0.13777422815,0.134342186924,0.124232982407,0.126956483523,0.123227762711,0.120403705622,0.113132415874,0.113132415874,0.108894078049,0.107534505925,0.106237304065,0.10483258939)
L_hpd_M95=c(0.397609695418, 0.397609695418,0.397609695418,0.398147641162,0.391912099018,0.31809898591,0.141928556921,0.130916268288,0.128430827596,0.128306942054,0.127490259401,0.127490259401,0.12674133734,0.12674133734,0.127706230897,0.129507148068,0.146817152732,0.164371615682,0.17354116384,0.186347360606,0.196006117158,0.202661906092,0.211038022093,0.221870698106,0.222628800231,0.223016652837,0.226311358527,0.224906447811,0.229377319871,0.241984081258,0.331594793226,0.428361635589,0.44365966079,0.443851668999,0.445621859487,0.451821732414,0.446836303069,0.44365966079,0.436922438122,0.439048934997,0.432075952921,0.436922438122,0.439580195885,0.439580195885,0.452078708857,0.4683842722,0.46957087685,0.46957087685,0.471841198449,0.471841198449)
M_hpd_m95=c(0.863804062177, 0.863804062177,0.0922602846453,0.0913752735327,0.0922602846453,0.0922602846453,0.0907981673177,0.0903692381322,0.0894087918173,0.0907981673177,0.0897742255404,0.0885620576021,0.0883442818401,0.0849290628443,0.0767972874243,0.0763596168392,0.0769981295827,0.0769981295827,0.0769548993179,0.0769548993179,0.0769548993179,0.0770615885954,0.0769548993179,0.0763596168392,0.0760552388604,0.0722335369342,0.068580687189,0.0629707024717,0.0600428140165,0.0556897311977,0.050878970535,0.052370831761,0.0517871851468,0.0483778271515,0.0409507724802,0.0363016744877,0.0239700195868,0.0205192028442,0.0229723255345,0.0187426261894,0.0224448039616,0.0170066517092,0.0192101670727,0.0187426261894,0.0170066517092,0.0170066517092,0.0170066517092,0.0170066517092,0.0170066517092,0.0170066517092)
M_hpd_M95=c(1.46486086707, 1.46486086707,0.17462711247,0.173686121308,0.17426759353,0.17426759353,0.170107451923,0.167880960042,0.166076911232,0.166008542981,0.164641222295,0.163539455614,0.163420410897,0.161516548356,0.144023107205,0.138592904968,0.135225889744,0.132879956235,0.132879956235,0.132408801984,0.132284160137,0.132727956334,0.132475033473,0.132727956334,0.134880276123,0.133504400043,0.133504400043,0.12942540641,0.130156609795,0.128978006277,0.124235962025,0.127803291801,0.128108218895,0.128108218895,0.128627503165,0.135677713511,0.12816344962,0.128789410027,0.135677713511,0.135556741483,0.142611257334,0.144069999182,0.150721947867,0.155331803532,0.161883355191,0.161883355191,0.161883355191,0.161883355191,0.161883355191,0.161883355191)
R_hpd_m95=c(-1.21348375521, -1.21348375521,0.0460781986262,0.0444963326647,-0.0312724074232,-0.0986758607135,-0.108380019869,-0.101543448066,-0.097732344706,-0.0954854706669,-0.0945498759583,-0.0945498759583,-0.0908535654831,-0.0908535654831,-0.077155431221,-0.0700365583617,-0.066256831986,-0.059751642487,-0.059751642487,-0.0527465362929,-0.0441195178945,-0.0342040958639,-0.0328108257175,-0.0226696386695,-0.0199903504575,-0.0157148299479,-0.0157148299479,-0.0115388908891,-0.0114724349565,-0.0181293190314,-0.0153279820893,0.0295443314677,0.038388457697,0.0509122384883,0.0537528666456,0.0509122384883,0.0509122384883,0.0509122384883,0.0509122384883,0.0381166965879,0.0318179744652,0.0276539816699,0.011384815477,0.011384815477,-0.0106819219169,-0.00412211357157,-0.0106819219169,-0.0121104785709,-0.0121104785709,-0.0121104785709)
R_hpd_M95=c(-0.572438242475, -0.572438242475,0.272961710501,0.272961710501,0.264396219504,0.209617028322,0.0306974802575,0.0223596668507,0.0223596668507,0.0228493044971,0.0228493044971,0.0228493044971,0.0264062051603,0.0256528340958,0.0308837644166,0.0349197440632,0.0464913808648,0.0650236218387,0.0777229560565,0.0883610167254,0.100849068472,0.110055544564,0.112754097223,0.122952276782,0.126418547144,0.13209755195,0.134059972835,0.140966696064,0.143473769893,0.155853036365,0.24579062431,0.341915828319,0.351622980823,0.362998754777,0.362498913944,0.361643572681,0.361643572681,0.363557327549,0.365084829887,0.361929820329,0.360316594081,0.36556128413,0.361929820329,0.373945599334,0.383819495145,0.417063674303,0.418340124207,0.417993440739,0.421545563482,0.42374612368)
L_mean=c(0.288001947147, 0.288001947147,0.287998507002,0.287790036848,0.27473069165,0.152504974254,0.0891616770443,0.0861814975605,0.0854625739156,0.0854382341881,0.0852580381413,0.0853622297921,0.0851711934466,0.0851662691122,0.0854852280004,0.0860953764186,0.0908368071196,0.100684158391,0.108856520234,0.12126317487,0.131876972059,0.139875562963,0.148230749892,0.156324541019,0.158948160707,0.159301396949,0.159337743567,0.159362933984,0.159707703502,0.164115492261,0.191701299035,0.272733202982,0.285967851575,0.289262094184,0.292146302218,0.291745116648,0.290018414634,0.288746343237,0.286591117784,0.284667402135,0.283140892571,0.284028787515,0.28491669423,0.285262900444,0.289525415786,0.293516180513,0.293759484035,0.293490320994,0.293566109094,0.293692118746)
M_mean=c(1.15865748306, 1.15865748306,0.126544322553,0.126372850564,0.126212886713,0.126029332194,0.125422525175,0.124454379983,0.123440325518,0.122900424356,0.122048299442,0.120854623178,0.119286359476,0.116498037644,0.11011817953,0.107149918823,0.105777711917,0.105242881834,0.10510925735,0.10493824928,0.104980590384,0.104722104632,0.104457661337,0.103900334509,0.102731217985,0.101373243548,0.100076718339,0.098107787193,0.0960344875409,0.0939172868212,0.0928495073326,0.092700002394,0.0924352541017,0.0922030169327,0.090425731794,0.0883878466919,0.0872632243603,0.0867613728393,0.0868180510086,0.0875641335008,0.0881590245345,0.0894902130247,0.090676132834,0.0915345985502,0.0930724685852,0.0930724685852,0.0930724685852,0.0930724685852,0.0930724685852,0.0930724685852)
R_mean=c(-0.870655535915, -0.870655535915,0.161454184448,0.161417186284,0.148517804936,0.02647564206,-0.0362608481308,-0.0382728824224,-0.0379777516023,-0.0374621901679,-0.0367902613003,-0.0354923933855,-0.034115166029,-0.0313317685315,-0.02463295153,-0.0210545424046,-0.0149409047973,-0.00455872344293,0.00374726288358,0.01632492559,0.0268963816749,0.035153458331,0.0437730885552,0.0524242065102,0.056216942722,0.0579281534003,0.0592610252281,0.0612551467914,0.0636732159613,0.0701982054402,0.0988517917019,0.180033200588,0.193532597473,0.197059077251,0.201720570424,0.203357269956,0.202755190274,0.201984970398,0.199773066776,0.197103268634,0.194981868036,0.194538574491,0.194240561396,0.193728301894,0.196452947201,0.200443711928,0.200687015449,0.200417852409,0.200493640509,0.200619650161)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.519025318293), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.61134695378), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.33483213073, 0.466120736048), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()