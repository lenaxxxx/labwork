# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/labwork/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/labwork/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.130875981217, 0.130875981217,0.130875981217,0.130875981217,0.131060689089,0.0562134828978,0.052879480317,0.0477415024007,0.0544657462003,0.0550558409006,0.0550558409006,0.0550558409006,0.0550558409006,0.0550558409006,0.0550558409006,0.0544657462003,0.052879480317,0.0590212896244,0.0590212896244,0.061907829435,0.0716474818093,0.086127356778,0.0909097694639,0.103853846757,0.102704497457,0.102704497457,0.102704497457,0.102704497457,0.102704497457,0.102704497457,0.102704497457,0.110455545105,0.130875981217,0.122315500999,0.124743330943,0.122315500999,0.122315500999,0.122315500999,0.122315500999,0.112930724342,0.124743330943,0.124743330943,0.122315500999,0.122315500999,0.112930724342,0.112930724342,0.122315500999,0.122315500999,0.122315500999,0.122315500999,0.122315500999)
L_hpd_M95=c(0.357328853846, 0.357328853846,0.357328853846,0.357328853846,0.366609218172,0.337436444829,0.263849843573,0.144799281376,0.144799281376,0.144552915445,0.144552915445,0.144552915445,0.144552915445,0.144552915445,0.144799281376,0.144799281376,0.153200983345,0.161544248094,0.161544248094,0.1838200795,0.20577529643,0.211513887669,0.217866676087,0.226336661801,0.217866676087,0.217866676087,0.217866676087,0.218823801504,0.221312169694,0.239199254751,0.25328142327,0.355690067932,0.379610017823,0.377169805165,0.391916112636,0.399660411183,0.399660411183,0.391916112636,0.406851036566,0.406851036566,0.429244367019,0.429244367019,0.429244367019,0.429244367019,0.436239220836,0.460701214111,0.494587165984,0.494587165984,0.501700903801,0.501700903801,0.501700903801)
M_hpd_m95=c(0.924151754869, 0.924151754869,0.097555754013,0.097555754013,0.097555754013,0.097555754013,0.09619904589,0.09619904589,0.0940818650753,0.0940818650753,0.0940818650753,0.0940818650753,0.0940818650753,0.0940818650753,0.0940818650753,0.0851081763991,0.0796476068281,0.0796476068281,0.0783604950439,0.0783604950439,0.0774080227827,0.0774080227827,0.0657367148278,0.057835582084,0.0496830546457,0.0496830546457,0.0482930270618,0.0482930270618,0.0482930270618,0.0482930270618,0.0482930270618,0.0482930270618,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0337601518562,0.0482930270618,0.0482930270618,0.0482930270618,0.0482930270618,0.0482930270618,0.0482930270618)
M_hpd_M95=c(1.63178217718, 1.63178217718,0.165273110306,0.165273110306,0.165273110306,0.165273110306,0.165273110306,0.165273110306,0.159739795281,0.155327886921,0.155327886921,0.155327886921,0.155327886921,0.155327886921,0.155327886921,0.155327886921,0.149567883272,0.150690653911,0.147318944151,0.149115367253,0.147318944151,0.149567883272,0.148364364988,0.145604810305,0.131866140701,0.131413971077,0.127667796016,0.127667796016,0.127667796016,0.127667796016,0.127667796016,0.127667796016,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.112154891234,0.127667796016,0.127667796016,0.127667796016,0.127667796016,0.127667796016,0.127667796016)
R_hpd_m95=c(-1.31275579641, -1.31275579641,0.0320377510493,0.0320377510493,0.0110148886691,-0.0784927279612,-0.10172350433,-0.108055352388,-0.10172350433,-0.100680379368,-0.0979631036758,-0.0979631036758,-0.0979631036758,-0.0979631036758,-0.0826131534132,-0.0750731738605,-0.0689272190851,-0.0666578031867,-0.0712659966861,-0.0655066662417,-0.0514631568422,-0.0425303175446,-0.0343408631547,-0.0202011877274,-0.00568400145381,0.000685285692798,0.0170497026532,0.0170497026532,0.0129669205442,0.00816082910171,0.0170497026532,0.0237889135082,0.0329523453368,0.0329523453368,0.0264584819935,0.0419610235048,0.0419610235048,0.0442509718459,0.0442509718459,0.0395884693351,0.0442509718459,0.0442509718459,0.0395884693351,0.021536849916,0.0395884693351,0.0395884693351,0.00816082910171,0.00816082910171,0.0285126143103,0.0285126143103,0.0285126143103)
R_hpd_M95=c(-0.565327246845, -0.565327246845,0.244071035392,0.244071035392,0.243129499418,0.229307873024,0.155065442794,0.0210941052311,0.0210941052311,0.0210941052311,0.0210941052311,0.0210941052311,0.0210941052311,0.0210941052311,0.0290584511213,0.0290584511213,0.0433185181332,0.050757088236,0.0514912414194,0.0829198989928,0.10816210782,0.119928281355,0.125702310383,0.125992168341,0.138147803438,0.138147803438,0.154660333606,0.154660333606,0.147187619296,0.163607644461,0.183875271534,0.283079095677,0.299525871624,0.299525871624,0.313495251615,0.338282161645,0.338282161645,0.336018596813,0.336018596813,0.336018596813,0.352701526816,0.352701526816,0.352701526816,0.352701526816,0.39386075846,0.396694253696,0.396694253696,0.396694253696,0.43046279137,0.43046279137,0.43046279137)
L_mean=c(0.271606779582, 0.271606779582,0.271969988504,0.271969988504,0.26719745706,0.198054339576,0.112176571074,0.0936359411623,0.0918509193862,0.0921302343812,0.0922003987459,0.0920915051507,0.0920915051507,0.0920082688338,0.092404236815,0.0927749594393,0.0981127036825,0.103621845701,0.105940646864,0.120986524088,0.14174349248,0.149233571627,0.154368560073,0.158050487717,0.159578201926,0.159578201926,0.159858306428,0.160182039623,0.162953576072,0.167788401085,0.172608684443,0.208225327669,0.226758276195,0.23394715287,0.244467389881,0.250161231277,0.25048656912,0.250434530848,0.252869621637,0.253019544341,0.25426586097,0.254457443056,0.2578099055,0.258808135421,0.263982891355,0.265680313372,0.267630449054,0.267903455384,0.269367890689,0.269367890689,0.269367890689)
M_mean=c(1.16705826077, 1.16705826077,0.12781520439,0.12781520439,0.12781520439,0.12781520439,0.127381403657,0.127425940532,0.126819885074,0.125877314345,0.125854410602,0.125863064725,0.125863064725,0.125758590653,0.124246395085,0.121602508238,0.120857068468,0.11801203425,0.114103927737,0.113372457482,0.112821033144,0.111289816911,0.108294092438,0.101963493541,0.0901535638763,0.0862393319361,0.084518348236,0.0827996688147,0.0820574034196,0.0815393962581,0.0815393962581,0.0815393962581,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0814989636113,0.0815474271843,0.0818662628923,0.0818662628923,0.0818662628923,0.0818662628923,0.0818662628923,0.0818662628923)
R_mean=c(-0.895451481189, -0.895451481189,0.144154784114,0.144154784114,0.13938225267,0.0702391351853,-0.0152048325831,-0.03378999937,-0.0349689656873,-0.0337470799641,-0.0336540118561,-0.0337715595742,-0.0337715595742,-0.0337503218189,-0.0318421582699,-0.028827548799,-0.0227443647858,-0.0143901885488,-0.00816328087265,0.00761406660609,0.0289224593361,0.0379437547166,0.0460744676341,0.056086994176,0.06942463805,0.0733388699902,0.0753399581923,0.0773823708087,0.0808961726519,0.0862490048268,0.0910692881845,0.126685931411,0.145259312584,0.152448189258,0.16296842627,0.168662267665,0.168987605509,0.168935567237,0.171370658026,0.17152058073,0.172766897359,0.172958479444,0.176310941889,0.17730917181,0.182435464171,0.183814050479,0.185764186161,0.186037192492,0.187501627797,0.187501627797,0.187501627797)
trans=0.5
age=(0:(51-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.551870994181), xlim = c(-53.55,2.55), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.79496039489), xlim = c(-53.55,2.55), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.44403137605, 0.473509070507), xlim = c(-53.55,2.55), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-53.55,2.55), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()